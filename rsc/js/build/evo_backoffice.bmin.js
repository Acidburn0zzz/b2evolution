/* This includes 14 files: functions.js, ajax.js, form_extensions.js, backoffice.js, extracats.js, dynamic_select.js, src/evo_modal_window.js, src/evo_images.js, src/evo_user_crop.js, src/evo_user_report.js, src/evo_user_deldata.js, src/evo_user_org.js, src/evo_rest_api.js, src/evo_links.js */
function pop_up_window(a,b,c,d,e){void 0===c&&(c=750),void 0===d&&(d=550);var f=(screen.width-c)/2,g=(screen.height-d)/2;return void 0===e&&(e="scrollbars=yes, status=yes, resizable=yes, menubar=yes"),e="width="+c+", height="+d+", left="+f+", top="+g+", "+e,opened=window.open(a,b,e),opened.focus(),"undefined"==typeof openedWindows?openedWindows=new Array(opened):openedWindows.push(opened),!1}function textarea_replace_selection(a,b,c){textarea_wrap_selection(a,b,"",1,c)}function textarea_wrap_selection(a,b,c,d,e){e=e||document;var f={element:a,before:b,after:c,replace:d,target_document:e};if(!b2evo_Callbacks.trigger_callback("wrap_selection_for_"+a.id,f)){if(window.opener&&void 0!==window.opener)try{if(window.opener.b2evo_Callbacks&&void 0!==window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback("wrap_selection_for_"+a.id,f))return}catch(a){}if(!(window.parent&&void 0!==window.parent&&window.parent.b2evo_Callbacks&&void 0!==window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback("wrap_selection_for_"+a.id,f)))if(e.selection)a.focus(),sel=e.selection.createRange(),sel.text=d?b+c:b+sel.text+c,a.focus();else if(a.selectionStart||"0"==a.selectionStart){var g,h,i,j=a.selectionStart,k=a.selectionEnd;"textarea"==a.type&&void 0!==a.scrollTop&&(h=a.scrollTop,i=a.scrollLeft),d?(a.value=a.value.substring(0,j)+b+c+a.value.substring(k,a.value.length),g=j+b.length+c.length):(a.value=a.value.substring(0,j)+b+a.value.substring(j,k)+c+a.value.substring(k,a.value.length),g=k+b.length+c.length),void 0!==h&&(a.scrollTop=h,a.scrollLeft=i),a.focus(),a.selectionStart=g,a.selectionEnd=g}else a.value+=b+c,a.focus()}}function textarea_str_replace(a,b,c,d){d=d||document;var e={element:a,search:b,replace:c,target_document:d};if(!b2evo_Callbacks.trigger_callback("str_replace_for_"+a.id,e)){if(window.opener&&void 0!==window.opener)try{if(window.opener.b2evo_Callbacks&&void 0!==window.opener.b2evo_Callbacks&&window.opener.b2evo_Callbacks.trigger_callback("str_replace_for_"+a.id,e))return}catch(a){}window.parent&&void 0!==window.parent&&window.parent.b2evo_Callbacks&&void 0!==window.parent.b2evo_Callbacks&&window.parent.b2evo_Callbacks.trigger_callback("str_replace_for_"+a.id,e)||(a.value=a.value.replace(b,c),a.focus())}}function toggle_filter_area(a){var b=jQuery("#clickdiv_"+a),c=jQuery("#clickimg_"+a);if(0==b.length||0==c.length)return alert("ID "+a+" not found!"),!1;if(c.hasClass("fa")||c.hasClass("glyphicon")){if(""!=c.data("toggle")&&void 0!=c.data("toggle")){var d=c.hasClass("fa")?"fa":"glyphicon";void 0==c.data("toggle-orig-class")&&c.data("toggle-orig-class",c.attr("class").replace(new RegExp("^"+d+" (.+)$","g"),"$1")),c.hasClass(c.data("toggle-orig-class"))?c.removeClass(c.data("toggle-orig-class")).addClass(d+"-"+c.data("toggle")):c.removeClass(d+"-"+c.data("toggle")).addClass(c.data("toggle-orig-class"))}}else{var e=c.css("background-position").match(/-*\d+/g);c.css("background-position",parseInt(e[0])+(b.is(":hidden")?-16:16)+"px "+parseInt(e[1])+"px")}return b.is(":hidden")?(b.slideDown(500),jQuery.post(htsrv_url+"anon_async.php?action=expand_filter&target="+a)):(b.slideUp(500),jQuery.post(htsrv_url+"anon_async.php?action=collapse_filter&target="+a)),!1}function b2evo_Callbacks(){this.eventHandlers=new Array}function evoAlert(a){var b=jQuery(".b2evo_alert");b.length>0&&b.remove(),jQuery("body").append('<div class="b2evo_alert">'+a+"</div>"),setTimeout(function(){jQuery(".b2evo_alert").fadeOut({complete:function(){jQuery(this).remove()}})},3e3),evo_alert_events_initialized||(evo_alert_events_initialized=!0,jQuery(document).on("click",".b2evo_alert",function(){jQuery(this).remove()}))}function ajax_debug_clear(a){var b=/<!-- Ajax response end -->/;return a=a.replace(b,""),a=a.replace(/(<div class="jslog">[\s\S]*)/i,""),jQuery.trim(a)}function ajax_response_is_correct(a){var b=/<!-- Ajax response end -->/;return!!a.match(b)&&""!=(a=ajax_debug_clear(a))}function get_form(a){for(;"FORM"!=a.tagName;){if(void 0===a)return!1;a=a.parentNode}return a}function check(a,b){if(form_obj=get_form(a),!form_obj)return alert("Could not find form"),!1;for(i=0;i<form_obj.length;)"checkbox"==form_obj.elements[i].type&&(form_obj.elements[i].checked=b),i++;return!1}function check_all(a){return target=findTarget(a),check(target,!0),cancelClick(a),!1}function uncheck_all(a){return target=findTarget(a),check(target,!1),cancelClick(a),!1}function cancelClick(a){return window.event&&window.event.returnValue&&(window.event.returnValue=!1),a&&a.preventDefault&&a.preventDefault(),!1}function surround_check(a,b,c){var d=findTarget(a);for(el_form=get_form(d),el_inputs=el_form.getElementsByTagName("INPUT"),i=0;i<el_inputs.length;i++)el_input=el_inputs[i],"checkbox"==el_input.type&&(null!=c&&el_input.checked!=c||(el_input.parentNode.className=b))}function surround_unchecked(a){surround_check(a,"checkbox_surround",!1)}function surround_checked(a){surround_check(a,"checkbox_surround",!0)}function unsurround_all(a){surround_check(a,"checkbox_surround_init",null)}function init_check_all(){for(var a=document.getElementsByName("check_all_nocheckchanges"),b=0;b<a.length;b++){var c=a[b];jQuery(c).bind({click:check_all,mouseover:surround_unchecked,mouseout:unsurround_all})}for(var d=document.getElementsByName("uncheck_all_nocheckchanges"),b=0;b<d.length;b++){var c=d[b];jQuery(c).bind({click:uncheck_all,mouseover:surround_checked,mouseout:unsurround_all})}}function clear_form(a){for(a=check(a,!1),i=0;i<a.length;)"text"==a.elements[i].type&&(a.elements[i].value=""),i++;return a}function focus_on_first_input(){if(all_inputs=document.getElementsByTagName("input"),all_inputs.length)for(i=0;i<all_inputs.length;i++)if("text"==all_inputs[i].type&&1!=all_inputs[i].disabled){try{all_inputs[i].focus()}catch(a){}break}}function check_combo(a,b,c){"new"==b?(input_text=document.getElementById(a+"_combo"),input_text.style.display="inline",input_text.focus()):(input_text=document.getElementById(a+"_combo"),input_text.style.display="none")}function input_decorated_help(a,b){var c=document.getElementById(a),d=function(){""!=c.value&&c.value!=b||(c.style.color="#666",c.value=b)};jQuery(c).bind("blur",d),jQuery(c).bind("focus",function(){c.style.color="",c.value==b&&(c.value="")}),jQuery(c.form).bind("submit",function(){c.value==b&&(c.value="")}),d()}function findTarget(a){var b;if(window.event&&window.event.srcElement?b=window.event.srcElement:a&&a.target&&(b=a.target),!b)return null;for(;b!=document.body&&"a"!=b.nodeName.toLowerCase();)b=b.parentNode;return"a"!=b.nodeName.toLowerCase()?null:b}function check_extracat(a){for(var b=a.value,c=document.getElementsByName("post_extracats[]"),d=0;d<c.length;d++){var e=c[d];e.value==b&&(e.checked=!0)}}function init_dynamicSelect(){for(var a=0;a<nb_dynamicSelects;a++)dynamicSelect(tab_dynamicSelects[a].parent,tab_dynamicSelects[a].child)}function dynamicSelect(a,b){if(document.getElementById&&document.getElementsByTagName){var c=document.getElementById(a),d=document.getElementById(b),e=d.cloneNode(!0),f=e.getElementsByTagName("option");refreshDynamicSelectOptions(c,d,f),c.onchange=function(){refreshDynamicSelectOptions(c,d,f)}}}function refreshDynamicSelectOptions(a,b,c){for(;b.options.length;)b.remove(0);for(var d=new RegExp("^"+a.options[a.selectedIndex].value+"-.*$"),e=0;e<c.length;e++)(c[e].value.match(d)||""==c[e].value)&&b.appendChild(c[e].cloneNode(!0))}function toggle_clickopen(a,b,c){if(!(clickdiv=document.getElementById("clickdiv_"+a))||!(clickimg=document.getElementById("clickimg_"+a)))return alert("ID "+a+" not found!"),!1;if(void 0===b&&(b="none"!=clickdiv.style.display),void 0===c&&(c=""),clickimg=jQuery(clickimg),clickimg.hasClass("fa")||clickimg.hasClass("glyphicon")){if(""!=clickimg.data("toggle")){var d=clickimg.hasClass("fa")?"fa":"glyphicon";void 0==clickimg.data("toggle-orig-class")&&clickimg.data("toggle-orig-class",clickimg.attr("class").replace(new RegExp("^"+d+" (.+)$","g"),"$1")),clickimg.hasClass(clickimg.data("toggle-orig-class"))?clickimg.removeClass(clickimg.data("toggle-orig-class")).addClass(d+"-"+clickimg.data("toggle")):clickimg.removeClass(d+"-"+clickimg.data("toggle")).addClass(clickimg.data("toggle-orig-class"))}}else{var e=clickimg.css("background-position").match(/-*\d+/g);clickimg.css("background-position",parseInt(e[0])+(b?16:-16)+"px "+parseInt(e[1])+"px")}return clickdiv.style.display=b?"none":c,!1}function evoFadeSuccess(a){evoFadeBg(a,new Array("#ddff00","#bbff00"))}function evoFadeFailure(a){evoFadeBg(a,new Array("#9300ff","#ff000a","#ff0000"))}function evoFadeHighlight(a){evoFadeBg(a,new Array("#ffbf00","#ffe79f"))}function evoFadeBg(selector,bgs,options){var origBg=jQuery(selector).css("backgroundColor"),speed=options&&options.speed||'"slow"',toEval="jQuery(selector).animate({ backgroundColor: ";for(e in bgs)"string"==typeof bgs[e]&&(toEval+='"'+bgs[e]+'"}, '+speed+" ).animate({ backgroundColor: ");toEval+="origBg }, "+speed+', "", function(){jQuery( this ).css( "backgroundColor", "" );});',eval(toEval)}function set_new_form_action(a,b){a.attributes.getNamedItem("action").value;a.attributes.getNamedItem("action").value=b;var c=location.href.replace(/(\/)[^\/]*$/,"$1");return a.attributes.getNamedItem("action").value==b||a.attributes.getNamedItem("action").value==c+b||(a.action=b,a.attributes.getNamedItem("action").value==b)||(alert("set_new_form_action: Cannot set new form action (Safari workaround)."),!1)}function b2edit_update_item_preview(a,b,c){var d=jQuery(a).closest("form");if("iframe_item_preview"==d.attr("target"))return!1;if(void 0!==b&&!1!==b){var e=d.attr("action");if(!set_new_form_action(d.get(0),b))return alert("Preview not supported. Sorry. (Could not set form.action for preview)"),!1}if(void 0!==c){var f=d.find("input[name=action]").val();0==d.find("input[name=action]").length?d.append('<input type="hidden" name="action" value="'+c+'" />'):d.find("input[name=action]").val(c)}return d.attr("target","iframe_item_preview"),d.submit(),void 0!==b&&!1!==b&&d.attr("action",e),d.attr("target","_self"),void 0!==c&&d.find("input[name=action]").val(f),jQuery("#fieldset_wrapper_itemform_preview.folded").removeClass("folded"),!1}function b2edit_save_item(a,b){function c(a,b){0==jQuery(".action_messages").length&&jQuery(".page-content").before('<div class="action_messages container-fluid"><ul></ul></div>');var c=jQuery(".action_messages ul");c.html("");var e='<li><div class="alert alert-dismissible $message_class$ fade in"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span></button>$message$</div></li>';if("object"==typeof a.messages)for(var f=0;f<a.messages.length;f++)c.append(e.replace("$message_class$",d(a.messages[f][0])).replace("$message$",a.messages[f][1]));void 0!==a.error_info&&c.append(e.replace("$message_class$",d("error")).replace("$message$",a.error_info)),void 0!==a.message&&c.append(e.replace("$message_class$",d(b)).replace("$message$",a.message))}function d(a){var b="alert-info";switch(a){case"error":b="alert-danger";break;case"success":b="alert-success";break;case"warning":b="alert-warning"}return b}var e=jQuery(a).closest("form"),f=e.find("input[name=post_ID]").val(),g={};return e.find("input, select, textarea").each(function(){var a=jQuery(this).attr("name"),b=jQuery(this).val(),c=jQuery(this).attr("type");if(void 0!==a&&""!=a&&("checkbox"!=c&&"radio"!=c||jQuery(this).is(":checked")))if(void 0!==g[a]&&-1!=a.indexOf("[")){if("object"!=typeof g[a]){var d=g[a];g[a]=[],g[a].push(d)}g[a].push(b)}else g[a]=b}),evo_rest_api_request("collections/"+b+"/items/"+(f>0?f+"/update":"create"),g,function(b){c(b,"success"),b2edit_update_item_preview(a,b.coll_url),0==f&&(e.find("input[name=post_ID]").val(b.item_ID),e.find('input[name^="actionArray[create"]').each(function(){jQuery(this).attr("name",jQuery(this).attr("name").replace("[create","[update"))}),jQuery('a[href$="action=new_type"]').each(function(){jQuery(this).attr("href",jQuery(this).attr("href").replace("action=new_type","action=edit_type&post_ID="+b.item_ID)),jQuery(this).attr("onclick",jQuery(this).attr("onclick").replace("'new_type'","'edit_type'"))}),jQuery('a[href$="disp=edit"]').each(function(){jQuery(this).attr("href",jQuery(this).attr("href").replace("disp=edit","disp=edit&p="+b.item_ID))}),jQuery('a[href*="prev_action=new"]').each(function(){jQuery(this).attr("href",jQuery(this).attr("href").replace("prev_action=new","prev_action=edit&p="+b.item_ID))}))},"GET",function(a){if(c(a,"error"),jQuery(".field_error").each(function(){jQuery(this).removeClass("field_error"),jQuery(this).next().hasClass("help-inline")&&jQuery(this).next().remove()}),"object"==typeof a.field_errors)for(var b=0;b<a.field_errors.length;b++){var d=a.field_errors[b][0],e=a.field_errors[b][1];jQuery('[name="'+d+'"]').addClass("field_error").after('<span class="help-inline"><span class="field_error" rel="'+d+'">'+e+"</span></span>")}}),!1}function b2edit_reload(a,b,c,d,e){if(!set_new_form_action(a,b))return!1;var f=!1;if(a.elements.namedItem("actionArray[update]")?(jQuery(a).append('<input type="hidden" name="action" value="edit_switchtab" />'),f=!0):a.elements.namedItem("actionArray[create]")?(jQuery(a).append('<input type="hidden" name="action" value="new_switchtab" />'),f=!0):(jQuery(a).append('<input type="hidden" name="action" value="switchtab" />'),f=!0),f&&void 0!==d)for(param in d)jQuery(a).append('<input type="hidden" name="'+param+'" value="'+d[param]+'" />');return void 0!==c&&"undefined"!=c&&(null==c&&(c=""),a.elements.blog.value=c),window.onbeforeunload=null,void 0!==e&&1==e&&a.reset(),a.submit(),!1}function b2edit_type(a,b,c){var d=!1;return bozo.nb_changes>0&&(d=!confirm(a)),b2edit_reload(document.getElementById("item_checkchanges"),b,null,{action:c},d)}function b2edit_confirm(a,b,c){return!(bozo.nb_changes>0&&!confirm(a))&&b2edit_reload(document.getElementById("item_checkchanges"),b,null,{action:c},!1)}function b2edit_update_panel_cookie_param(a,b,c){var d="editscrnpanels"+("undefined"==typeof blog_id?"":"_"+blog_id)+("undefined"==typeof cookie_suffix?"_b2evo":cookie_suffix),e=jQuery.cookie(d);e=e?e.split(";"):[];for(var f=[],g=!1,h=0,i=e.length;h<i;h++){var j=e[h].match(/^([a-z0-9\-_]+)\(([^\)]+)\)$/i);if(j)if(a==j[1]){var k="";if(void 0!==c)k=","+c;else{var l=j[2].split(",");void 0!==l[1]&&(k=","+l[1])}f.push(j[1]+"("+b+k+")"),g=!0}else f.push(j[0])}g||f.push(a+"("+b+(void 0!==c?","+c:"")+")"),jQuery.cookie(d,f.join(";"),{path:"/",expires:3650})}function openModalWindow(a,b,c,d,e,f){var g="overlay_page_active";void 0!==d&&1==d&&(g="overlay_page_active_transparent"),void 0===b&&(b="560px");var h="";if(void 0!==c&&(c>0||""!=c)&&(h=' style="height:'+c+'"'),jQuery("#overlay_page").length>0)return void jQuery("#overlay_page").html(a);jQuery("body").append('<div id="screen_mask"></div><div id="overlay_wrap" style="width:'+b+'"><div id="overlay_layout"><div id="overlay_page"'+h+"></div></div></div>"),jQuery("#screen_mask").fadeTo(1,.5).fadeIn(200),jQuery("#overlay_page").html(a).addClass(g),jQuery(document).on("click","#close_button, #screen_mask, #overlay_page",function(a){if("overlay_page"==jQuery(this).attr("id")){var b=jQuery("#overlay_page form");if(b.length){var c=b.position().top+jQuery("#overlay_wrap").position().top,d=c+b.height();a.clientY>c&&a.clientY<d||closeModalWindow()}return!0}return closeModalWindow(),!1})}function closeModalWindow(a){return void 0===a&&(a=window.document),jQuery("#overlay_page",a).hide(),jQuery(".action_messages",a).remove(),jQuery("#server_messages",a).insertBefore(".first_payload_block"),jQuery("#overlay_wrap",a).remove(),jQuery("#screen_mask",a).remove(),!1}function user_crop_avatar(a,b,c){void 0===c&&(c="avatar");var d=750,e=320,f=jQuery(window).width(),g=jQuery(window).height(),h=f,i=g,j=i/h;i=i>d?d:i<e?e:i,h=h>d?d:h<e?e:h;var k=10,l=10;k=h-2*k>e?10:0,l=i-2*l>e?10:0;var m=h>d?d:h,n=i>d?d:i;openModalWindow('<span id="spinner" class="loader_img loader_user_report absolute_center" title="'+evo_js_lang_loading+'"></span>',m+"px",n+"px",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,"btn-primary"],!0);var o={top:parseInt(jQuery("div.modal-dialog div.modal-body").css("paddingTop")),right:parseInt(jQuery("div.modal-dialog div.modal-body").css("paddingRight")),bottom:parseInt(jQuery("div.modal-dialog div.modal-body").css("paddingBottom")),left:parseInt(jQuery("div.modal-dialog div.modal-body").css("paddingLeft"))},p=parseInt(jQuery("div.modal-dialog div.modal-body").css("min-height"))-(o.top+o.bottom),q=m-(o.left+o.right),r={user_ID:a,file_ID:b,aspect_ratio:j,content_width:q,content_height:p,display_mode:"js",crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(r.ctrl="user",r.user_tab="crop",r.user_tab_from=c):(r.blog=evo_js_blog,r.disp="avatar",r.action="crop"),jQuery.ajax({type:"POST",url:evo_js_user_crop_ajax_url,data:r,success:function(a){openModalWindow(a,m+"px",n+"px",!0,evo_js_lang_crop_profile_pic,[evo_js_lang_crop,"btn-primary"])}}),!1}function user_report(a,b){openModalWindow('<span class="loader_img loader_user_report absolute_center" title="'+evo_js_lang_loading+'"></span>',"auto","",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,"btn-danger"],!0);var c={action:"get_user_report_form",user_ID:a,crumb_user:evo_js_crumb_user};return evo_js_is_backoffice?(c.is_backoffice=1,c.user_tab=b):c.blog=evo_js_blog,jQuery.ajax({type:"POST",url:evo_js_user_report_ajax_url,data:c,success:function(a){openModalWindow(a,"auto","",!0,evo_js_lang_report_user,[evo_js_lang_report_this_user_now,"btn-danger"])}}),!1}function user_deldata(a,b){return openModalWindow('<span class="loader_img loader_user_deldata absolute_center" title="'+evo_js_lang_loading+'"></span>',"auto","",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,"btn-danger"],!0),jQuery.ajax({type:"POST",url:evo_js_user_deldata_ajax_url,data:{ctrl:"user",user_tab:"deldata",user_tab_from:b,user_ID:a,display_mode:"js",crumb_user:evo_js_crumb_user},success:function(a){openModalWindow(a,"auto","",!0,evo_js_lang_delete_user_data,[evo_js_lang_delete_selected_data,"btn-danger"])}}),!1}function user_add_org(a){return openModalWindow('<span class="loader_img loader_user_deldata absolute_center" title="'+evo_js_lang_loading+'"></span>',"450px","",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add,!0),jQuery.ajax({type:"POST",url:evo_js_user_org_ajax_url,data:{ctrl:"organizations",action:"add_user",org_ID:a,display_mode:"js",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,"450px","",!0,evo_js_lang_add_user_to_organization,evo_js_lang_add),jQuery("input.autocomplete_login").trigger("added")}}),!1}function user_edit(a,b){return openModalWindow('<span class="loader_img loader_user_deldata absolute_center" title="'+evo_js_lang_loading+'"></span>',"450px","",!0,evo_js_lang_edit_membership,evo_js_lang_edit,!0),jQuery.ajax({type:"POST",url:evo_js_user_org_ajax_url,data:{ctrl:"organizations",action:"edit_user",org_ID:a,user_ID:b,display_mode:"js",crumb_user:evo_js_crumb_organization},success:function(a){openModalWindow(a,"450px","",!0,evo_js_lang_edit_membership,evo_js_lang_edit)}}),!1}function evo_rest_api_request(url,params_func,func_method,method,func_fail){var params=params_func,func=func_method;"function"==typeof params_func&&(func=params_func,params={},method=func_method),void 0===method&&(method="GET"),jQuery.ajax({contentType:"application/json; charset=utf-8",type:method,url:restapi_url+url,data:params}).then(function(data,textStatus,jqXHR){"object"==typeof jqXHR.responseJSON&&eval(func)(data,textStatus,jqXHR)},function(jqXHR){b2evo_show_debug_ajax_error=!1,"function"==typeof func_fail&&"object"==typeof jqXHR.responseJSON&&eval(func_fail)(jqXHR.responseJSON,jqXHR)})}function evo_link_fix_wrapper_height(){var a=jQuery("#attachments_fieldset_table").height();jQuery("#attachments_fieldset_wrapper").height()>a&&jQuery("#attachments_fieldset_wrapper").height(jQuery("#attachments_fieldset_table").height())}function evo_link_change_position(a,b,c){var d=a,e=a.value;return jQuery.get(b+"async.php?action=set_object_link_position&link_ID="+a.id.substr(17)+"&link_position="+e+"&crumb_link="+c,{},function(b,c){b=ajax_debug_clear(b),"OK"==b?(evoFadeSuccess(jQuery(d).closest("tr")),jQuery(d).closest("td").removeClass("error"),"cover"==e&&jQuery("select[name=link_position][id!="+a.id+"] option[value=cover]:selected").each(function(){jQuery(this).parent().val("aftermore"),evoFadeSuccess(jQuery(this).closest("tr"))})):(jQuery(d).val(b),evoFadeFailure(jQuery(d).closest("tr")),jQuery(d.form).closest("td").addClass("error"))}),!1}function evo_link_insert_inline(a,b,c){var d=window.document.getElementById("itemform_post_content");if(null!=d){var e="["+a+":"+b;c.length&&(console.log(c.length),e+=":"+c),e+="]",textarea_wrap_selection(d,e,"",0,window.document);var f=jQuery("#display_position_"+b);0!=f.length&&"inline"!=f.val()&&f.val("inline").change()}}function evo_link_delete(a,b,c,d){return evo_rest_api_request("links/"+c,{action:d},function(d){if("item"==b){var e=window.document.getElementById("itemform_post_content");if(null!=e){textarea_str_replace(e,new RegExp("\\[(image|file|inline|video|audio):"+c+":?[^\\]]*\\]","ig"),"",window.document)}}jQuery(a).closest("tr").remove(),evo_link_fix_wrapper_height()},"DELETE"),!1}function evo_link_change_order(a,b,c){return evo_rest_api_request("links/"+b+"/"+c,function(b){var d=jQuery(a).closest("tr");"move_up"==c?d.prev().before(d):d.next().after(d),evoFadeSuccess(d)},"POST"),!1}function evo_link_attach(a,b,c,d){return evo_rest_api_request("links",{action:"attach",type:a,object_ID:b,root:c,path:d},function(a){var b=jQuery("#attachments_fieldset_table table",window.parent.document);b.length>0&&void 0!==a.link&&b.append('<tr><td class="firstcol shrinkwrap">'+a.link.preview+'</td><td class="fm_filename">'+a.link.url+'</td><td class="shrinkwrap link_id_cell">'+a.link.ID+'</td><td class="shrinkwrap">'+a.link.actions+'</td><td class="lastcol shrinkwrap">'+a.link.position+"</td></tr>")}),!1}function evo_link_ajax_loading_overlay(){var a=jQuery("#attachments_fieldset_table"),b=!1;return 0==a.find(".results_ajax_loading").length&&(b=jQuery('<div class="results_ajax_loading"><div>&nbsp;</div></div>'),a.css("position","relative"),b.css({width:a.width(),height:a.height()}),a.append(b)),b}function evo_link_refresh_list(a,b,c){var d=evo_link_ajax_loading_overlay();return d&&evo_rest_api_request("links",{action:void 0===c?"refresh":"sort",type:a,object_ID:b},function(a){jQuery("#attachments_fieldset_table").html(a.html),d.remove(),evo_link_fix_wrapper_height()}),!1}b2evo_Callbacks.prototype={register_callback:function(a,b,c){void 0===this.eventHandlers[a]&&(this.eventHandlers[a]=new Array),void 0!==c&&c?this.eventHandlers[a][0]=b:this.eventHandlers[a][this.eventHandlers[a].length]=b},trigger_callback:function(event,args){if(void 0===this.eventHandlers[event])return null;for(var r=!1,cb_args="",cb_arguments=arguments,i=1;i<arguments.length;i++)cb_args+="cb_arguments["+i+"], ";cb_args.length&&(cb_args=cb_args.substring(0,cb_args.length-2));for(var i=0;i<this.eventHandlers[event].length;i++){var f=this.eventHandlers[event][i];r=eval("f("+cb_args+");")||r}return r}};var b2evo_Callbacks=new b2evo_Callbacks;evo_alert_events_initialized=!1,jQuery(document).ready(function(){function a(a){var b=jQuery("."+a.val()+"_toolbar");if(0==b.length)return!0;a.is(":checked")?(b.removeClass("disabled"),b.find("input[type=button]").removeAttr("disabled")):(b.addClass("disabled"),b.find("input[type=button]").attr("disabled","disabled"))}jQuery(document).on("click","[data-func]",function(){var a=jQuery(this).data("func").match(/([^\\|]|\\\|)+/g),b=a[0];a.splice(0,1);for(var c=0;c<a.length;c++)"b2evoCanvas"==a[c]?a[c]=b2evoCanvas:" "==a[c]?a[c]="":a[c]=a[c].replace(/\\\|/g,"|");return!(jQuery(this).closest(".disabled[class*=_toolbar]").length>0)&&(window[b].apply(null,a),!1)}),jQuery('input[type=checkbox][name="renderers[]"]').each(function(){a(jQuery(this))}),jQuery('input[type=checkbox][name="renderers[]"]').click(function(){a(jQuery(this))})}),jQuery(document).ready(function(){jQuery("[id^=fadeout-]").each(function(){evoFadeBg(this,new Array("#FFFF33"),{speed:3e3})})}),jQuery(document).on("change",".btn-file :file",function(){var a=jQuery(this).val().replace(/\\/g,"/").replace(/.*\//,"");jQuery(this).parent().next().html(a)}),jQuery(document).ready(function(){function a(){if(jQuery(".evo_item_form__right_col").hasClass("evo_item_form__full_width_col")){jQuery(".evo_item_form__left_col").addClass("evo_item_form__full_width_col");var a="100"}else var a=(jQuery(".evo_item_form__left_col").width()/(jQuery(".evo_item_form__left_col").width()+jQuery(".evo_item_form__right_col").width())*100).toFixed(3);jQuery.cookie("b2evo_item_edit_column_width"+("undefined"==typeof blog_id?"":"_"+blog_id),a,{path:"/",expires:3650})}if(0!=jQuery("#item_checkchanges").length){var b,c=320;jQuery(".evo_item_form__left_col").resizable({minWidth:c,handles:"e",start:function(a,c){b=c.element.hasClass("evo_item_form__full_width_col")?c.element.width():c.element.width()+c.element.next().width(),c.element.removeClass("evo_item_form__full_width_col"),c.element.find(".ui-resizable-handle").addClass("active_handler"),jQuery("#iframe_item_preview_wrapper").append('<div id="iframe_item_preview_disabler"></div>')},resize:function(a,d){if(b-d.element.width()<c)d.element.next().addClass("evo_item_form__full_width_col");else{d.element.next().width(b-d.element.width()).removeClass("evo_item_form__full_width_col");var e=(d.element.width()/(d.element.width()+d.element.next().width())*100).toFixed(3);d.element.css("width",e+"%"),d.element.next().css("width",100-e+"%")}},stop:function(b,c){c.element.find(".ui-resizable-handle").removeClass("active_handler"),jQuery("#iframe_item_preview_disabler").remove(),a()}}),jQuery(window).on("resize",function(b){if(b.target===window&&(jQuery(window).width()<960&&jQuery(".evo_item_form__left_col, .evo_item_form__right_col").addClass("evo_item_form__full_width_col"),jQuery(".evo_item_form__left_col").width()<c||jQuery(".evo_item_form__right_col").width()<c)){if(jQuery(".evo_item_form__left_col").width()<jQuery(".evo_item_form__right_col").width())var d=jQuery(".evo_item_form__left_col"),e=jQuery(".evo_item_form__right_col");else var d=jQuery(".evo_item_form__right_col"),e=jQuery(".evo_item_form__left_col");var f=(c/jQuery(window).width()*100).toFixed(3);d.css("width",f+"%"),e.css("width",100-f+"%"),a()}})}}),jQuery(document).ready(function(){function a(){var a=jQuery("#iframe_item_preview").contents().find("body").height();0==a&&(a=600),""==jQuery("#iframe_item_preview_wrapper").prop("style").height&&a>jQuery("#iframe_item_preview_wrapper").height()&&jQuery("#iframe_item_preview_wrapper").css("height",a<600?a:600),jQuery("#iframe_item_preview_wrapper").css("max-height",a)}if(0!=jQuery("#iframe_item_preview_wrapper").length){var b=!1;jQuery("#iframe_item_preview").bind("load",function(){b||(a(),b=!0)}),jQuery("#icon_folding_itemform_preview, #title_folding_itemform_preview").click(function(){a()}),jQuery("#iframe_item_preview_wrapper").resizable({minHeight:80,handles:"s",start:function(a,b){b.element.append('<div id="iframe_item_preview_disabler"></div>')},stop:function(a,b){b.element.find("#iframe_item_preview_disabler").remove(),b2edit_update_panel_cookie_param("itemform_preview","open",jQuery(this).height())},resize:function(a,b){jQuery("#iframe_item_preview_wrapper").resizable("option","maxHeight",jQuery("#iframe_item_preview").contents().find("body").height())}}),jQuery(document).on("click","#iframe_item_preview_wrapper .ui-resizable-handle",function(){jQuery("#iframe_item_preview_wrapper").css("height",jQuery("#iframe_item_preview_wrapper").height()+80)})}}),jQuery(document).keyup(function(a){27==a.keyCode&&closeModalWindow()}),jQuery(document).ready(function(){jQuery("img.loadimg").each(function(){jQuery(this).prop("complete")?jQuery(this).removeClass("loadimg"):jQuery(this).on("load",function(){jQuery(this).removeClass("loadimg")})})}),jQuery(document).ready(function(){var a=jQuery("#attachments_fieldset_table").height();(""==jQuery("#attachments_fieldset_wrapper").prop("style").height||jQuery("#attachments_fieldset_wrapper").height()>a)&&(a=a>320?320:a<97?97:a,jQuery("#attachments_fieldset_wrapper").height(a)),jQuery("#attachments_fieldset_wrapper").resizable({minHeight:80,handles:"s",stop:function(a,b){b2edit_update_panel_cookie_param(jQuery(this).closest("fieldset.fieldset").attr("id"),"open",jQuery(this).height())},resize:function(a,b){jQuery("#attachments_fieldset_wrapper").resizable("option","maxHeight",jQuery("#attachments_fieldset_table").height())}}),jQuery(document).on("click","#attachments_fieldset_wrapper .ui-resizable-handle",function(){var a=jQuery("#attachments_fieldset_table").height(),b=jQuery("#attachments_fieldset_wrapper").height()+80;jQuery("#attachments_fieldset_wrapper").css("height",b>a?a:b)})});